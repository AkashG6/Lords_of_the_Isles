
<!doctype html>
<html lang="en"><!DOCTYPE html>
<html>
<head>
	<title>Island</title>
	<meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
	<style type="text/css">

      body {
          /*background: url('assets/bg/i1.png') no-repeat fixed;*/
          /*background: url('assets/bg/i3.jpg') no-repeat fixed;*/
          background: url('assets/bg/i5.jpg') no-repeat fixed;
          -webkit-background-size: cover;
          -moz-background-size: cover;
          -o-background-size: cover;
          background-size: cover;
      }

    </style>
    
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" type="text/css" href="css/island.css">

    <script type="text/javascript">
    	var a = 60;
    	var b = parseInt(a/12);
    	var text = '<b>Population</b> <br>'+a+'<br> <b>Resources consumed</b><br>'+b+' per tick';

      $(document).ready(function(){
          $('[data-toggle="popover"]').popover({
              placement : 'right',
              trigger : 'hover',
              html : true,
              content : text 
          });
      });
    </script>


    


</head>
<body>

  
	
	<div class="help" data-toggle="modal" data-target="#ques" > 
      <img width="50" height="50" src="assets/buttons/ques.png" data-container="body" data-toggle="popover" data-placement="left" data-content="Click for help">
 	 </div>

  <div class="modal fade" id="ques" tabindex="-1" role="dialog" aria-labelledby="ques" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="ques">Your owned island</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        // what your can do here
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
<!-- 
<div class="row" >
		<div class="col-md-5">
			
		</div>
		<div class="col-md-2">
			<div class="name">
				
			</div>
		</div>
		<div class="col-md-5">
			
		</div>
	
</div>
 -->


<div class="col-md-4" style="color: green;margin-left: -15px;">
      <center>     
        <div class="name" style="background-color: #A7E9F9;opacity: 0.9; width: 300%; ">
          <div style="opacity: 1">
            <script type="text/javascript">
              var name = localStorage.getItem("i_name");
              var user = localStorage.getItem("user");
              var old = localStorage.getItem("old");
              var time = 60;
              var time_int;

              function buy_ship(){

                  $.ajax({
                    type: 'POST',
                    url: '/buy_ship',
                    data:{user:localStorage.getItem("user"), island:localStorage.getItem("i_name")},
                    success: function(data){
                      alert("You new ship is anchored at "+localStorage.getItem("i_name"));
                      parent.window.ship_menu.location.reload();
                    }
                  });
                }

              function buy_island(reply){

                $('#buy_btn').hide();
                $('#ign_btn').hide();
                $('#timer').hide();

                clearInterval(time_int);

                $.ajax({
                        type: 'POST',
                        url: '/assign_island',
                        data: {username:user, island:name, reply:reply, old:old},
                        success: function(data){
                            console.log("Assign island successfull");
                            parent.window.island_menu.location.reload();
                        }
                    });
              }

              document.write(name);

              $(document).ready(function(){
                $.ajax({
                    type:'POST',
                    url:'/get_island_info',
                    data:{island:name},
                    success: function(result){

                        console.log("island "+result);

                        var owner = result[0].owner_name;

                        if(owner=='AI'){
                          $('#owner').text("Owner: Not Owned");

                          console.log(localStorage.getItem("user_click"));
                          
                          if(localStorage.getItem("user_click") == 0){

                            var tr = 'true';
                            var fl = 'false';
                            var text = "Buy: "+result[0].value;

                            $('#info_div').append('<button style="margin:10px" class="btn btn-success" onclick="buy_island('+tr+')" id="buy_btn">'+text+'</button>');
                            $('#info_div').append('<button style="margin:10px" class="btn btn-danger" onclick="buy_island('+fl+')" id="ign_btn">Ignore</button><br><br>');
                            $('#info_div').append('<p id="timer"></p>');
                          }
                        }

                        else{
                          $('#owner').text("Owner:"+owner);
                        }

                        $('#res_table').empty();

                        $('#res_table').append(
                            '<tr>'+
                                '<th>Resource</th>'+
                                '<th>Quantity</th>'+
                            '</tr>'

                        );

                        for(i=0;i<result[0].res_present.length;i++){
                          if(result[0].res_present[i].quantity){
                            $('#res_table').append(
                                '<tr>'+
                                    '<td>'+result[0].res_present[i].name+'</td>'+
                                    '<td>'+result[0].res_present[i].quantity+'</td>'+
                                    // '<td>'+result[0].res_present[i].value+'</td>'+
                                '</tr>'
                            );
                          }
                            
                        }

                        if(localStorage.getItem("user_click") == 0 && owner == 'AI'){
                            time_int = setInterval(function(){
                            $('#timer').text("Time left to buy :"+time);
                            time--;

                            if(time == 0){
                              buy_island('false');
                              $('#buy_btn').hide();
                              $('#ign_btn').hide();
                              $('#timer').hide();
                              clearInterval(time_int);
                            }
                          },1000);
                        }
                    }

                });
              });
            </script>
          </div> 
        </div>
      </center>
    </div>


    <div style="margin-top:10%">
      <center>

        <div style="background-color:white" id="info_div">
            <h4 id="owner"></h4>

            <table border="1px" id="res_table">
                <tr>
                    <th>Resource</th>
                    <th>Quantity</th>
                </tr>
            </table><br><br>
    
        </div>

      </center>
    </div>

      
    <button style="float:right" class="btn btn-success" onclick="buy_ship()">Buy Ship</button>

<div class="man1" >
	<img class="man" src="assets/bg/m.png" data-container="body" data-toggle="popover" data-placement="right">
</div>

 <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
    <!-- <script src="https://code.jquery.com/jquery-3.2.1.slim.min.js" integrity="sha384-KJ3o2DKtIkvYIK3UENzmM7KCkRr/rE9/Qpg6aAZGJwFDMVNA/GpGFF93hXpG5KkN" crossorigin="anonymous"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

</body>
</html>